import java.applet.*;
import java.awt.*;
import java.awt.event.*;

public class MidiPlayer extends Applet
{
  AudioClip mus[];
  Button play,stop,back,next;
  Image bg;
  int num,cur=0;
  String name[];

 public void init()
 {
   try{
   num=Integer.parseInt(getParameter("num"));	//取得檔案數目參數
   }
   catch(NumberFormatException e){};
   mus=new AudioClip[num];			//建立AudioClip物件陣列
   name=new String[num];			//建立檔名陣列
   try{
	   for(int i=0;i<num;i++){
	   name[i]=getParameter("name"+i);	//取得音樂檔名
	   }
   }	
   catch(NumberFormatException e){};
   for(int j=0;j<num;j++){
   mus[j]=getAudioClip(getCodeBase(),name[j]);	//逐一取得檔名途徑
   }
   play=new Button("play");
   stop=new Button("stop");
   back=new Button("back");
   next=new Button("next");
   bg=getImage(getCodeBase(),"bg.jpg");
   setLayout(new FlowLayout(FlowLayout.CENTER,5,50));
   add(back);
   add(play);
   add(stop);
   add(next);
   back.addActionListener(new baction());
   play.addActionListener(new paction());
   stop.addActionListener(new saction());
   next.addActionListener(new naction());
 }

 public void stop()
  {
	mus[cur].stop();
  }
 
 public void paint(Graphics g)
  {
    g.drawImage(bg,0,0,this);
    g.setColor(Color.black);
    g.fillRect(20,15,150,25);				//畫方塊
    g.setColor(Color.green);
    g.drawString(name[cur],25,33);			//顯示歌曲檔名
  }
  
 class baction implements ActionListener
 {
   public void actionPerformed(ActionEvent event)
   {
    mus[cur].stop();					//停止播放目前音樂
    cur=(--cur)%num;					//目前數目減一
    if(cur<=0) cur=0;					//若小於等於零則設為零
    repaint();
   }
 }

 class paction implements ActionListener
 {
   public void actionPerformed(ActionEvent event)
   {
    mus[cur].play();
    repaint();
   }
 }

 class saction implements ActionListener
 {
   public void actionPerformed(ActionEvent event)
   {
    mus[cur].stop();
    repaint();
   }
 }

 class naction implements ActionListener
 {
   public void actionPerformed(ActionEvent event)
   {
    mus[cur].stop();
    cur=(++cur)%num;					//目前數目加一
    repaint();
   }
 }

}